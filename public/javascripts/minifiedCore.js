!function(t){var e={};function o(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=2)}([function(t,e,o){"use strict";e.__esModule=!0,e.registeredAuctions={};var n=function(){return function(t,e){this.bids=[],this.registerAuction=function(){this.auctionID="A"+this.slotID.toString()},this.closeAuction=function(){console.log("closing auction.."),this.status=!0},this.getWinner=function(){for(var t,e=0,o=0,n=this.bids;o<n.length;o++){var i=n[o];i.CPM>e&&(t=i,e=i.CPM)}this.winner=t},this.getStatus=function(){return console.log("auction",this.auctionID,"is",this.status?"Closed":"Active"),this.status},this.addBids=function(t){this.bids.push(t)},this.slotID=t,this.slotSize=e,this.status=!1}}();e.Auction=n,e.closeAuctions=function(){for(var t in e.registeredAuctions)e.registeredAuctions[t].closeAuction(),e.registeredAuctions[t].getWinner(),console.log(e.registeredAuctions[t])}},function(t,e,o){"use strict";function n(t,e){var o=new XMLHttpRequest;console.log("postinggg"),o.open("POST","http://localhost:3000/log/"+t,!0),o.setRequestHeader("Content-Type","application/json; charset=UTF-8"),o.send(JSON.stringify(e)),o.onreadystatechange=function(){4==this.readyState&&200==this.status&&console.log("Logs fired!")}}e.__esModule=!0,e.logProviderResponse=function(t){console.log("provider response",t),n("providerResponses",t)},e.logAuctionParticipant=function(t){n("auctionParticipants",t)},e.logAuctionWinner=function(t){n("auctionWinners",t)}},function(t,e,o){"use strict";e.__esModule=!0;for(var n=o(0),i=o(3),r=o(1),s={},c=0,u=config.adslots;c<u.length;c++){var l=(P=u[c]).divID;s.hasOwnProperty(l)||(s[l]=P.slot_id)}for(var a={},d=0,f=config.providers;d<f.length;d++){var g=f[d],h=g.ID;a.hasOwnProperty(h)||(a[h]=g.Name)}window.hbShow=function(t){var e=document.getElementById(t),o=document.createElement("iframe");e.appendChild(o);var i="A"+s[t],r=n.registeredAuctions[i],c=r.winner.code.toString();c=function(t){for(var e in a)-1!=t.indexOf(e)&&(t=t.replace(e,a[e]));return t}(c);var u=r.slotSize.split("x")[1];o.setAttribute("height",u),o.setAttribute("srcdoc",c),console.log(e,"got rendered!")};for(var p=0,v=config.adslots;p<v.length;p++){var P=v[p],A=new n.Auction(P.slot_id,P.dimension);A.registerAuction(),n.registeredAuctions[A.auctionID]=A,i.createAdapter(A).then(function(){n.closeAuctions(),r.logAuctionWinner(n.registeredAuctions)})}},function(t,e,o){"use strict";e.__esModule=!0;var n=o(0),i=o(1),r=[],s=[],c=function(){return function(t,e,o,n){this.CPM=t,this.code=e,this.EPC=o,this.provider=n}}(),u=function(){return function(t,e,o,n,i,s,c){this.getBid=function(){return function(t){return r.push(t),new Promise(function(t,e){if(r.length==config.AdslotProvidersMap.length){var o=new XMLHttpRequest;o.open("POST","http://localhost:3000/getBid",!0),o.setRequestHeader("Content-Type","application/json; charset=UTF-8"),o.timeout=300,o.send(JSON.stringify(r)),o.ontimeout=function(t){console.log("No bids received.Could not complete in 300ms")},o.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.responseText);e.length==config.AdslotProvidersMap.length&&(console.log("all bids received",e),t(e))}}}})}({slotID:this.slotID,EPC:this.EPC,providerID:this.providerID,floorPrice:this.floorPrice,size:this.size})},this.auctionID=t,this.noBid=e,this.slotID=o,this.EPC=n,this.size=i,this.providerID=s,this.floorPrice=c}}();e.createAdapter=function(t){return console.log("current",t),new Promise(function(e,o){for(var r=0,l=config.AdslotProvidersMap;r<l.length;r++){var a=l[r];if(a.slotID==t.slotID){var d=new u(t.auctionID,!0,a.slotID,a.ExternalPlacementID,t.slotSize,a.providerID,a.FloorPrice);s.push(d),d.getBid().then(function(t){i.logProviderResponse(t);for(var o=0,r=s;o<r.length;o++)for(var u=r[o],l=0,a=t;l<a.length;l++){var d=a[l];if(u.providerID==d.providerID&&u.slotID==d.slotID){var f=u.auctionID,g=new c((h=d).CPM,h.code,h.EPC,h.providerID);n.registeredAuctions[f].addBids(g)}}var h;i.logAuctionParticipant(n.registeredAuctions),e(!0)})}}})}}]);